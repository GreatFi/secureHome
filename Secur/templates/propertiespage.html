<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&family=Inter:opsz,wght@14..32,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Urbanist:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <script src="/static/fontawesome-free-6.7.2-web/js/all.js"></script>
    <link rel="stylesheet" href="/static/css/securehome.css">
    <title>Properties</title>
</head>
<body>
            <nav class="nav-bar">
                <div class="logo">
                    <h3>Secure Home</h3>
                    <button class="BARS"><i class="fas fa-bars  bars"></i></button>
                </div>

                <div class="nav-links hide">
                    <a href="{% url 'homepage' %}">Home</a>
                    <a class="aboutus-link" href="{% url 'aboutus' %}">About</a>
                    <a href="{% url 'propertiesPage' %}">Properties</a>
                    <a href="{% url 'servicesPage' %}">Services</a>
                </div>

                <div class="nav-btn">
                {% if user.is_authenticated %}
                    <a class="btn44" href="{% url 'dashboard' %}">Go to Dashboard</a>
                {% else %}
                <button class="btn43"><a href="{% url 'createaccount' %}">Signup</a></button>
                <button class="btn44"><a href="{% url 'login' %}" style="color: whitesmoke;">Login</a></button>
                {% endif %}
                </div>
            </nav>

            <div class="prop-hero-section">
                <div class="searchBar-cont">
                    <form action="{% url 'search_results' %}" method="get" class="first-form">
                        <div class="search-bar">
                            <i class="fas fa-magnifying-glass mag"></i>
                            <input class="search-input" type="search" placeholder="Enter a reference" name="query">
                        </div>
                </div>
                <div class="second-form">

                    <label for="lga">SELECT LGA:</label>
                    <select style="width: 100%;" name="lga" id="lga" required>
                    <option value="">-- Select an LGA --</option>
                    {% for value, label in lga_choices %}
                        <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                    </select>

                    <label for="Town">SELECT TOWN:</label>
                    <select style="width: 100%;" name="Town" id="Town" required disabled>
                    <option value="">-- Select Town --</option>
                    </select>
                    <select name="houseType" id="houseType" required>
                        <option value="">Select house type</option>
                        <option value="apartment" {% if prop.houseType == 'apartment' %}selected{% endif %}>Apartment</option>
                        <option value="bungalow" {% if prop.houseType == 'bungalow' %}selected{% endif %}>Bungalow</option>
                        <option value="duplex" {% if prop.houseType == 'duplex' %}selected{% endif %}>Duplex</option>
                        <option value="land" {% if prop.houseType == 'land' %}selected{% endif %}>Land</option>
                    </select><br><br>
                    <select name="prop_choices" id="prop_choices">
                        <option value="sale" {% if prop_choices == 'sale' %}selected{% endif %}>For Sale</option>
                        <option value="rent" {% if prop_choices == 'rent' %}selected{% endif %}>For Rent</option>
                    </select>
                    <label for="min_price">Min Price (₦):</label>
                    <input 
                        type="number" 
                        name="min_price" 
                        id="min_price" 
                        placeholder="Min"
                        value="{{ min_price }}"
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"
                    >
                    <label for="max_price">Max Price (₦):</label>
                    <input 
                        type="number" 
                        name="max_price" 
                        id="max_price" 
                        placeholder="Max"
                        value="{{ max_price }}"
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"
                    >
                    <label for="min_size">Min size</label>
                    <input 
                        type="number" 
                        name="min_size" 
                        id="min_size" 
                        placeholder="Min"
                        value="{{ min_size }}"
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"
                    >
                    <label for="max_size">Max size</label>
                    <input 
                        type="number" 
                        name="max_size" 
                        id="max_size" 
                        placeholder="Max"
                        value="{{ max_size }}"
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"
                    >

                        <button class="find" type="submit">Find</button>
                    </form>
                </div>
            </div>

            {% comment %}  Properties {% endcomment %}
            
            <div class="propForSale">
                <div class="for-sale">
                    <h1 class="sale-h1">Properties up for Sale</h1>
                    <p class="sale-p">Discover a wide range of properties uploaded by owners and licensed agents.We connect you directly to the right opportunities</p>
                </div>
                <div class="propSale-cont">

                {% for proprender in prop_rendering %}
                    <div class="landing-card">
                        <div class="features-img">
                            {% if proprender.image1 %}
                                <img src="{{ proprender.image1.url }}" alt="{{ proprender.propertyName }}" class="features-img">
                            {% else %}
                                <img src="/static/images/placeholder.jpg" alt="No image" class="features-img">
                            {% endif %}
                        </div>
                        <div class="text-div">
                            <h2 class="properties-card-header">{{ proprender.propertyName }}</h2>
                            <p class="properties-card-para">{{ proprender.moreDescription | truncatechars:20 }}</p>
                        </div>
                        <div class="specs">
                            <div class="specs-info">
                                <i class="fa-solid fa-bed"></i>
                                <p>{{ proprender.bedrooms }}-bedroom</p>
                            </div>
                            <div class="specs-info">
                                <i class="fa-solid fa-bath"></i>
                                <p>{{ proprender.bathrooms }}-bathroom</p>
                            </div>
                            <div class="specs-infos">
                                <i class="fa-solid fa-building e"></i>
                                <p>{{ proprender.houseType }}</p>
                            </div>
                        </div>
                        <div class="price">
                            <div>
                                <p class="Price">Price</p>
                                <p class="price-figs">₦{{ proprender.price }}</p>
                            </div>
                            <a href="{% url 'propdetails' proprender.id %}" class="feature-button">View Property Details</a>
                        </div>
                    </div>
                {% empty %}
                    <p style="color: red; padding: 20px; font-size: 18px;">No properties listed yet!</p>
                {% endfor %}
            </div>

            </div>
            <div class="propForRent">
                <div class="for-rent">
                    <h1 class="rent-h1">Properties up for Rent</h1>
                    <p class="rent-p">Looking for a place to call home? Explore Rentals that suit your lifestyle</p>
                </div>
                <div class="propRent-cont">
                    {% for rentedprops in rent_prop %}
                    <div class="landing-card">
                        <div class="features-img"><img src="{{rentedprops.image1.url}}" alt="" class="features-img"></div>
                        <div class="text-div">
                            <h2 class="properties-card-header">{{ rentedprops.propertyName}}</h2>
                            <p class="properties-card-para">{{ rentedprops.moreDescription }}</p>
                        </div>
                        <div class="specs">
                            <div class="specs-info">
                                <i class="fa-solid fa-bed bed"></i>
                                <p>{{ rentedprops.bedrooms}}-bedroom</p>
                            </div>
                            <div class="specs-info">
                                <i class="fa-solid fa-bath bed"></i>
                                <p>{{rentedprops.bathrooms}}-bathroom</p>
                            </div>
                            <div class="specs-infos">
                                <i class="fa-solid fa-building e"></i>
                                <p>{{rentedprops.houseType}}</p>
                            </div>
                        </div>
                        <div class="price">
                            <div>
                                <p class="Price">Price</p>
                                <p class="price-figs">{{rentedprops.price}}/yr</p>
                            </div>
                            <a href="{% url 'propdetails' rentedprops.id%}" class="feature-button">View Property Details</a>
                        </div>
                    </div>
                    {% endfor %}
                    <div class="landing-card">
                        <div class="features-img"><img src="/static/Images/sky.avif" alt="" class="features-img"></div>
                        <div class="text-div">
                            <h2 class="properties-card-header">Roadside King Apartments</h2>
                            <p class="properties-card-para">A stunning 4-bedroom, 3-bathroom duplex in a peaceful suburban neighborhood... </p>
                        </div>
                        <div class="specs">
                            <div class="specs-info">
                                <i class="fa-solid fa-bed bed"></i>
                                <p>4-bedroom</p>
                            </div>
                            <div class="specs-info">
                                <i class="fa-solid fa-bath bed"></i>
                                <p>5-bathroom</p>
                            </div>
                            <div class="specs-infos">
                                <i class="fa-solid fa-building e"></i>
                                <p>Apartment</p>
                            </div>
                        </div>
                        <div class="price">
                            <div>
                                <p class="Price">Price</p>
                                <p class="price-figs">$5,000/yr</p>
                            </div>
                            <button class="feature-button">View Property Details</button>
                        </div>
                    </div>
                    <div class="landing-card">
                        <div class="features-img"><img src="/static/Images/dark-house.avif" alt="" class="features-img"></div>
                        <div class="text-div">
                            <h2 class="properties-card-header">Roadside King Duplex</h2>
                            <p class="properties-card-para">A stunning 4-bedroom, 3-bathroom duplex in a peaceful suburban neighborhood... </p>
                        </div>
                        <div class="specs">
                            <div class="specs-info">
                                <i class="fa-solid fa-bed bed"></i>
                                <p>4-bedroom</p>
                            </div>
                            <div class="specs-info">
                                <i class="fa-solid fa-bath bed"></i>
                                <p>5-bathroom</p>
                            </div>
                            <div class="specs-infos">
                                <i class="fa-solid fa-building e"></i>
                                <p>Apartment</p>
                            </div>
                        </div>
                        <div class="price">
                            <div>
                                <p class="Price">Price</p>
                                <p class="price-figs">$5,000/yr</p>
                            </div>
                            <button class="feature-button">View Property Details</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="cta">
                <div class="cta-card">
                    <h3 class="cta-card-heading">Start Your Real Estate Journey Today</h3>
                    <p class="cta-card-para">Your dream property is just a click away. Whether you're looking for a new home, a strategic investment, or expert real estate advice, Estatein is here to assist you every step of the way. Take the first step towards your real estate goals and explore our available properties or get in touch with our team for personalized assistance.</p>
                    <button class="cta-card-btn">Get Started</button>
                </div>
            </div>    
        <footer>
                <div class="first-footer-row">
                        <div class="subscribe">
                            <h3 class="sub-h3">Subscribe to our Newsletter</h3>
                            <input class="sub-input" type="email" placeholder="Enter email address">
                            <button class="sub-btn">Subscribe</button>
                        </div>    
                    <div class="quicklinks">
                        <div class="quick"><h3>Quick Links</h3></div>

                        <a class="footer-links1" href="{% url 'homepage' %}">Home</a>
                        <a class="footer-links1" href="">Browse Properties</a>
                        <a class="footer-links1" href="">List a Property</a>
                        <a class="footer-links1" href="">Ownership Transfer</a>
                        <a href="{% url 'createaccount' %}">Register</a>
                        <a class="footer-links1" href="">Help&Support</a>
                    </div>
                    <div class="legal">
                        <h3 class="legal">LEGAL</h3>
                        <a class="footer-links2"  href="">Terms & Conditions</a>
                        <a class="footer-links2"  href="">Privacy Policy</a>
                    </div>
                    <div class="contact">
                        <h3 class="contact">Contact</h3>
                        <div>
                            <p class="contact-p">Enugu State Ministry of Lands & Urban Development, Govt. House</p>
                        </div>
                        <div class="phone">
                            <i class="fas fa-phone h"></i>
                            <p>: +234 XXX XXX XXXX</p>
                        </div>
                        <div class="mail">
                            <i class="fas fa-envelope m"></i>
                            <p>:support@securehomeenugustate.gmail.com</p>
                        </div>
                    </div>
                    <div>
                        <div class="socials">
                            <i class="fab fa-facebook z"></i>
                            <i class="fab fa-twitter x"></i>
                            <i class="fab fa-instagram y"></i>
                        </div>
                    </div>
                    <hr>
                </div>    

                <hr class="hr">

                <div class="second-footer-row">
                    <div>
                        <div class="copyright">
                            <div class="cr">
                                <i class="fas fa-copyright"></i>
                                <p>2025 Enugu State Government. All Rights Reserved.</p>
                            </div>
                            <h3>Secure Home</h3>
                        </div>
                    </div>
                </div>
        </footer> 
    <script src="/static/js/nike.js"></script> 
<script>

const townsByLGA = {{ towns_by_lga|safe }};

// ✅ Get DOM elements
const lgaSelect = document.getElementById('lga');
const townSelect = document.getElementById('Town');

const currentLGA = "{{ prop.lga }}";
const currentTown = "{{ prop.Town }}";
console.log("Script loaded");
console.log("townsByLGA:", townsByLGA);
console.log("lgaSelect:", lgaSelect);
console.log("townSelect:", townSelect);


function populateTowns(lgaValue, selectedTown = null) {

    townSelect.innerHTML = '<option value="">-- Select Town --</option>';
    
    // If LGA is selected and has towns
    if (lgaValue && townsByLGA[lgaValue]) {
        // Enable the town dropdown
        townSelect.disabled = false;
        
        // Add all towns for this LGA
        townsByLGA[lgaValue].forEach(function([value, label]) {
            const option = document.createElement('option');
            option.value = value;
            option.textContent = label;
            
            // ✅ Pre-select town if it matches (for editing existing properties)
            if (selectedTown && value === selectedTown) {
                option.selected = true;
            }
            
            townSelect.appendChild(option);
        });
    } else {
        // No LGA selected - disable town dropdown
        townSelect.disabled = true;
    }
}

if (currentLGA) {
    populateTowns(currentLGA, currentTown);
}


lgaSelect.addEventListener('change', function() {
    const selectedLGA = this.value;
    populateTowns(selectedLGA);
});
</script>
</body>
</html>