<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&family=Inter:opsz,wght@14..32,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Urbanist:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <script src="/static/fontawesome-free-6.7.2-web/js/all.js"></script>
    <link rel="stylesheet" href="/static/css/securehome.css">
    <title>{{ propdets.propertyName }} - Property Details</title>
</head>
<body>
    <div>
        <nav class="nav-bar">
            <div class="logo">
                <h3>Secure Home</h3>
                <button class="BARS"><i class="fas fa-bars bars"></i></button>
            </div>
            <div class="nav-links hide">
                <a href="">Home</a>
                <a class="aboutus-link" href="{% url 'aboutus' %}">About</a>
                <a href="{% url 'propertiesPage' %}">Properties</a>
                <a href="{% url 'servicesPage' %}">Services</a>
            </div>
            <div class="nav-btn">
                {% if user.is_authenticated %}
                <button class="btn50"><a href="{% url 'dashboard' %}">Go to Dashboard</a></button>
                {% else %}
                <button class="btn43"><a href="{% url 'createaccount' %}">Signup</a></button>
                <button class="btn44"><a href="{% url 'login' %}" style="color: whitesmoke;">Login</a></button>
                {% endif %}
            </div>
        </nav>

        <!-- Property Details Section -->
        <div style="max-width: 1200px; margin: 50px auto; padding: 20px;">
            <h1>{{ propdets.propertyName }}</h1>
            <p><strong>Location:</strong> {{ propdets.location }}</p>
            <p><strong>Price:</strong> ₦{{ propdets.price }} {% if propdets.is_negotiable %}(Negotiable){% endif %}</p>
            <p><strong>Type:</strong> {{ propdets.get_houseType_display }}</p>
            <p><strong>Bedrooms:</strong> {{ propdets.bedrooms }} | <strong>Bathrooms:</strong> {{ propdets.bathrooms }}</p>
            <p><strong>Size:</strong> {{ propdets.prop_size }} sqm</p>
        </div>

        <!-- Image Gallery -->
        <div class="featured">
          {% if propdets.image1 %}
            <img src="{{ propdets.image1.url }}" id="featured-img" alt="{{ propdets.propertyName }}">
          {% else %}
            <img src="/static/images/placeholder.jpg" id="featured-img" alt="No image">
          {% endif %}
          <button id="prev" class="nav-btn">❮</button>
          <button id="next" class="nav-btn">❯</button>
        </div>

        <div class="thumbnails">
          {% if propdets.image1 %}
            <img src="{{ propdets.image1.url }}" class="thumb active" alt="Image 1">
          {% endif %}
          {% if propdets.image2 %}
            <img src="{{ propdets.image2.url }}" class="thumb" alt="Image 2">
          {% endif %}
          {% if propdets.image3 %}
            <img src="{{ propdets.image3.url }}" class="thumb" alt="Image 3">
          {% endif %}
        </div>

        <div style="max-width: 1200px; margin: 30px auto; padding: 20px;">
          <h2>Description</h2>
          <p>{{ propdets.moreDescription }}</p>
          
          <h3>Contact Information</h3>
          <p><strong>Phone:</strong> {{ propdets.contact_phone }}</p>
          <p><strong>Email:</strong> {{ propdets.email }}</p>
        </div>
    </div>
      
<script>
document.addEventListener('DOMContentLoaded', () => {
  let featuredImg = document.getElementById("featured-img");
  const thumbs = Array.from(document.querySelectorAll(".thumb"));
  const prev = document.getElementById("prev");
  const next = document.getElementById("next");
  let index = 0;
  let isAnimating = false;

  // Only run if we have thumbnails
  if (thumbs.length === 0) return;

  // Make sure featured starts with first thumbnail
  thumbs.forEach(t => t.classList.remove('active'));
  thumbs[0].classList.add('active');
  if (featuredImg) featuredImg.src = thumbs[0].src;

  function slideTo(newIndex, direction = 1) {
    if (isAnimating || newIndex === index) return;
    isAnimating = true;
    thumbs[index].classList.remove('active');

    const oldImg = featuredImg;
    const newImg = document.createElement('img');
    newImg.src = thumbs[newIndex].src;
    newImg.alt = thumbs[newIndex].alt || '';
    Object.assign(newImg.style, {
      position: 'absolute',
      top: '0',
      left: '0',
      width: '100%',
      height: '100%',
      objectFit: 'cover',
      willChange: 'transform',
      transform: `translateX(${direction === 1 ? '100%' : '-100%'})`,
      transition: 'transform 0.45s ease'
    });
    newImg.style.zIndex = 2;
    if (oldImg) {
      oldImg.style.zIndex = 1;
      oldImg.style.transform = 'translateX(0)';
      oldImg.style.transition = 'transform 0.45s ease';
    }

    oldImg.parentElement.appendChild(newImg);

    const startTransition = () => {
      requestAnimationFrame(() => {
        if (oldImg) oldImg.style.transform = `translateX(${direction === 1 ? '-100%' : '100%'})`;
        newImg.style.transform = 'translateX(0)';
      });
    };

    if (newImg.complete) {
      startTransition();
    } else {
      newImg.onload = startTransition;
      newImg.onerror = () => {
        if (oldImg) oldImg.src = newImg.src;
        newImg.remove();
        thumbs[newIndex].classList.add('active');
        index = newIndex;
        isAnimating = false;
      };
    }

    newImg.addEventListener('transitionend', function onEnd(e) {
      if (e.propertyName !== 'transform') return;
      newImg.removeEventListener('transitionend', onEnd);
      if (oldImg) oldImg.remove();
      newImg.id = 'featured-img';
      featuredImg = newImg;
      index = newIndex;
      thumbs[index].classList.add('active');
      isAnimating = false;
    });
  }

  thumbs.forEach((thumb, i) => {
    thumb.addEventListener('click', () => {
      const dir = i > index ? 1 : -1;
      slideTo(i, dir);
    });
  });

  next.addEventListener('click', () => {
    slideTo((index + 1) % thumbs.length, 1);
  });

  prev.addEventListener('click', () => {
    slideTo((index - 1 + thumbs.length) % thumbs.length, -1);
  });
});
</script>

</body>
</html>